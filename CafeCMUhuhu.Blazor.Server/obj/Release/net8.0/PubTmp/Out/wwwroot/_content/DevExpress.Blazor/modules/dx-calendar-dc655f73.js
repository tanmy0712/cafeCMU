import{d as e}from"./dom-da46d023.js";import{D as t}from"./dx-html-element-base-fd84f3f8.js";import{C as s}from"./css-classes-cee8476c.js";import{_ as n}from"./_tslib-6e8ca86b.js";import{H as a,D as i,L as r,a as o,b as l,c as d,d as h}from"./dx-html-element-pointer-events-helper-b4d2ae7e.js";import{S as c}from"./single-slot-element-base-9e7a4622.js";import{b as u}from"./constants-86572358.js";import{n as m}from"./property-4ec0b52d.js";import{R as D}from"./layouthelper-0c7c89da.js";import{C as y}from"./custom-events-helper-e7f279d3.js";import{K as g,D as p}from"./keyboard-navigation-strategy-940ff3b3.js";import{k as v}from"./key-f9cbed1b.js";class C{}var f,S;C.MainElement=s.Prefix+"-calendar",C.SelectedItem=C.MainElement+"-selected-item",C.SelectedRange=C.MainElement+"-selected-range",C.Header=C.MainElement+"-header",C.Content=C.MainElement+"-content",C.Footer=C.MainElement+"-footer",C.WeekRow=C.MainElement+"-week-row",C.YearRow=C.MainElement+"-year-row",C.DecadeRow=C.MainElement+"-decade-row",C.CenturyRow=C.MainElement+"-century-row",C.Day=C.MainElement+"-day",C.NotCurrentView=C.MainElement+"-not-current-view",C.HeaderHelper=C.MainElement+"-header",C.HeaderTitleButton=C.HeaderHelper+"-title-btn",C.HeaderPreviousYearButton=C.HeaderHelper+"-previous-year-btn",C.HeaderPreviousMonthButton=C.HeaderHelper+"-previous-month-btn",C.HeaderPreviousPeriodButton=C.HeaderHelper+"-previous-period-btn",C.HeaderNextYearButton=C.HeaderHelper+"-next-year-btn",C.HeaderNextMonthButton=C.HeaderHelper+"-next-month-btn",C.HeaderNextPeriodButton=C.HeaderHelper+"-next-period-btn",function(e){e.class="class",e.view="view",e.viewDate="view-date",e.enableMultiSelect="enable-multi-select",e.minDate="min-date",e.maxDate="max-date",e.visiblePeriodsCount="visible-periods-count",e.enableRangeSelect="enable-range-select",e.periodIndex="period-index",e.hasNullStartXorEndDate="has-null-start-xor-end-date"}(f||(f={})),function(e){e.dataDate="data-date",e.dataMonth="data-month",e.dataYear="data-year",e.dataDecade="data-decade"}(S||(S={}));const I=12,b="dxbl-calendar-table-container",x=new Date(new Date(Date.UTC(1,0,1)).setUTCFullYear(1)),E=new Date(Date.UTC(9999,11,31)),w=864e5;class T extends CustomEvent{constructor(e,t,s){super(T.eventName,{detail:new F(e,t,s),bubbles:!0,composed:!0,cancelable:!0})}}T.eventName=u+".daycellpointerup";class M extends Event{constructor(){super(M.eventName,{bubbles:!0,composed:!1,cancelable:!0})}}M.eventName=u+".keyboardnavigationleaved";class F{constructor(e,t,s){this.PointerDownDate=e,this.PointerUpDate=t,this.ClearSelection=s}}y.register(T.eventName,(e=>e.detail));class R{constructor(e,t){this._pointerDownDate=e.pointerDownDate,this._pointerUpDate=null,this._clearSelection=e.clearSelection,this.dayCellElements=e.dayCellElements,this._callback=t,this.refreshUI(!1)}get clearSelection(){return this._clearSelection}get pointerDownDate(){return this._pointerDownDate}get pointerUpDate(){return this._pointerUpDate}set pointerUpDate(e){this._pointerUpDate!==e&&e&&(this._pointerUpDate=e,this.refreshUI(!0))}get isValid(){return!!this._pointerUpDate}stop(){this.refreshUI(!1),this.isValid&&null!==this._callback&&this._callback(this._pointerDownDate,this._pointerUpDate,this._clearSelection)}cancel(){for(let e=0;e<this.dayCellElements.length;e++){const t=this.dayCellElements[e];R.removeDayCellSelectedClasses(t),t.hasAttribute("data-selected")&&R.addSelectedClassesToCell(t)}}refreshUI(t){const s=this.getStartPointedDateRange(),n=this.getEndPointedDateRange();for(let a=0;a<this.dayCellElements.length;a++){const i=this.dayCellElements[a];if(ee.isDateCellDisabled(i))continue;const r=Number(i.dataset.date);R.removeDayCellSelectedClasses(i),t&&this.isDateRangeBoundary(r,s,n)&&e.DomUtils.addClassName(i,C.SelectedRange),this.needApplySelectedStyle(r,s,n,t)&&R.addSelectedClassesToCell(i),i.hasAttribute("data-selected")&&!this.clearSelection&&R.addSelectedClassesToCell(i)}}getStartPointedDateRange(){return this.pointerUpDate?Math.min(this.pointerUpDate.getTime(),this.pointerDownDate.getTime()):this.pointerDownDate.getTime()}getEndPointedDateRange(){return this.pointerUpDate?Math.max(this.pointerUpDate.getTime(),this.pointerDownDate.getTime()):this.pointerDownDate.getTime()}needApplySelectedStyle(e,t,s,n){return!(e<t||e>s)&&(!n||!this.isDateRangeBoundary(e,t,s))}isDateRangeBoundary(e,t,s){if(!this.isDateDisabled(e)&&(e===t||e===s))return!0;return!(!(e>t&&e<s)||e!==this.getBoundaryDate(t,e)&&e!==this.getBoundaryDate(s,e))}getBoundaryDate(e,t){const s=e<t,n=s?1:-1;let a=e;for(;(s?a<t:a>t)&&this.isDateDisabled(a);)a+=n*w;return a}isDateDisabled(e){const t=this.getDayCellByDay(e);return null!=t&&ee.isDateCellDisabled(t)}getDayCellByDay(e){for(let t=0;t<this.dayCellElements.length;t++)if(this.dayCellElements[t].getAttribute(S.dataDate)===e.toString())return this.dayCellElements[t];return null}static addSelectedClassesToCell(t){e.DomUtils.addClassName(t,C.SelectedItem)}static removeDayCellSelectedClasses(t){e.DomUtils.removeClassName(t,C.SelectedItem),e.DomUtils.removeClassName(t,C.SelectedRange),e.DomUtils.removeClassName(t,"text-white")}}class P{constructor(e,t,s){this._pointerDownDate=e,this._pointerUpDate=null,this._clearSelection=t,this._callback=s}get clearSelection(){return this._clearSelection}get pointerDownDate(){return this._pointerDownDate}get pointerUpDate(){return this._pointerUpDate}set pointerUpDate(e){this._pointerUpDate=e}get isValid(){var e;return this.pointerDownDate.getTime()===(null===(e=this.pointerUpDate)||void 0===e?void 0:e.getTime())}stop(){null!==this._callback&&this._callback(this._pointerDownDate,this._pointerUpDate,this._clearSelection)}cancel(){}}class _{constructor(e,t){this._pointerDownDate=e.pointerDownDate,this._pointerUpDate=null,this._clearSelection=e.clearSelection,this.dayCellElements=e.dayCellElements,this._callback=t,this.refreshUI()}get clearSelection(){return this._clearSelection}get pointerDownDate(){return this._pointerDownDate}get pointerUpDate(){return this._pointerUpDate}set pointerUpDate(e){this._pointerUpDate!==e&&e&&(this._pointerUpDate=e,this.refreshUI())}get isValid(){return!!this._pointerUpDate}stop(){this.refreshUI(),this.isValid&&null!==this._callback&&this._callback(this._pointerDownDate,this._pointerUpDate,this._clearSelection)}cancel(){for(let e=0;e<this.dayCellElements.length;e++){const t=this.dayCellElements[e];_.removeDayCellSelectedClasses(t),t.hasAttribute("data-selected")&&_.addSelectedClassesToCell(t)}}refreshUI(){const t=this.getStartPointedDateRange(),s=this.getEndPointedDateRange();for(let n=0;n<this.dayCellElements.length;n++){const a=this.dayCellElements[n];if(ee.isDateCellDisabled(a))continue;const i=Number(a.dataset.date);_.removeDayCellSelectedClasses(a),this.isDateRangeBoundary(i,t,s)&&e.DomUtils.addClassName(a,C.SelectedRange),this.needApplySelectedStyle(i,t,s)&&_.addSelectedClassesToCell(a),a.hasAttribute("data-selected")&&!this.clearSelection&&_.addSelectedClassesToCell(a)}}getStartPointedDateRange(){return this.pointerUpDate?Math.min(this.pointerUpDate.getTime(),this.pointerDownDate.getTime()):this.pointerDownDate.getTime()}getEndPointedDateRange(){return this.pointerUpDate?Math.max(this.pointerUpDate.getTime(),this.pointerDownDate.getTime()):this.pointerDownDate.getTime()}needApplySelectedStyle(e,t,s){return!(e<t||e>s)&&!this.isDateRangeBoundary(e,t,s)}isDateRangeBoundary(e,t,s){if(!this.isDateDisabled(e)&&(e===t||e===s))return!0;return e>t&&e<s&&(e===this.getBoundaryDate(t,e)||e===this.getBoundaryDate(s,e))}getBoundaryDate(e,t){const s=e<t,n=s?1:-1;let a=e;for(;(s?a<t:a>t)&&this.isDateDisabled(a);)a+=n*w;return a}isDateDisabled(e){const t=this.getDayCellByDay(e);return null!=t&&ee.isDateCellDisabled(t)}getDayCellByDay(e){for(let t=0;t<this.dayCellElements.length;t++)if(this.dayCellElements[t].getAttribute(S.dataDate)===e.toString())return this.dayCellElements[t];return null}static addSelectedClassesToCell(t){e.DomUtils.addClassName(t,C.SelectedItem)}static removeDayCellSelectedClasses(t){e.DomUtils.removeClassName(t,C.SelectedItem),e.DomUtils.removeClassName(t,C.SelectedRange),e.DomUtils.removeClassName(t,"text-white")}}var H,N,K,B;!function(e){e[e.PreviousYear=0]="PreviousYear",e[e.PreviousMonth=1]="PreviousMonth",e[e.Title=2]="Title",e[e.NextMonth=3]="NextMonth",e[e.NextYear=4]="NextYear",e[e.PreviousPeriod=5]="PreviousPeriod",e[e.NextPeriod=6]="NextPeriod"}(H||(H={})),function(e){e[e.Header=0]="Header",e[e.DataTable=1]="DataTable",e[e.Footer=2]="Footer"}(N||(N={})),function(e){e[e.Month=0]="Month",e[e.Year=1]="Year",e[e.Decade=2]="Decade",e[e.Century=3]="Century"}(K||(K={})),function(e){e[e.January=0]="January",e[e.February=1]="February",e[e.March=2]="March",e[e.April=3]="April",e[e.May=4]="May",e[e.June=5]="June",e[e.July=6]="July",e[e.August=7]="August",e[e.September=8]="September",e[e.October=9]="October",e[e.November=10]="November",e[e.December=11]="December"}(B||(B={}));class U extends c{constructor(){super(),this._handlePointerEventsMode=a.None,this.viewDate=new Date,this.viewType=K.Month,this.periodIndex=0,this._pointerEventsHelper=new i(this)}get calendar(){return this._calendar||(this._calendar=e.DomUtils.getParentByTagName(this,u)),this._calendar}connectedCallback(){super.connectedCallback(),this._pointerEventsHelper.initialize()}disconnectedCallback(){super.disconnectedCallback(),this._pointerEventsHelper.dispose()}updated(e){e.has("viewDate")&&this.calendar.restoreFocus(),e.has("viewType")&&(this._handlePointerEventsMode=a.None,this.viewType===K.Month&&(this.calendar.fixCalendarTableSize(),this._handlePointerEventsMode=a.Click|a.Dragging),this.calendar.restoreFocus()),super.updated(e)}get handlePointerEventsMode(){return this._handlePointerEventsMode}get handlePointerEventsTarget(){return this}get handlePointerEventsDelay(){return r}get hoverTitleElementsSelector(){return null}get bypassNonInlineHoverTitleElementChildSelector(){return null}}n([m({attribute:f.viewDate,converter:e=>new Date(Number(e))})],U.prototype,"viewDate",void 0),n([m({type:Number,attribute:f.view})],U.prototype,"viewType",void 0),n([m({type:Number,attribute:f.periodIndex})],U.prototype,"periodIndex",void 0);class Y extends g{constructor(e,t){super(e.getKeyboardNavigator(),t),this.calendar=e}isFocusedFromOutside(){return this.calendar.isSameNode(document.activeElement)}isFocusedFromDataTable(){var e,t;return null!==(t=null===(e=this.getDataTableContainer())||void 0===e?void 0:e.contains(document.activeElement))&&void 0!==t&&t}getHeader(){return this.calendar.getHeaderElement()}getDataTableContainer(){return this.calendar.tableContainer}getFooter(){return this.calendar.getFooterElement()}}class k extends Y{constructor(e,t){super(e,t),this.itemSelector=`:scope > .${s.Button}:not(.${s.Disabled}), :scope > div.${C.HeaderTitleButton}:not(.${s.Disabled})`,this.buttonClassToButtonType=new Map([[C.HeaderPreviousYearButton,H.PreviousYear],[C.HeaderPreviousMonthButton,H.PreviousMonth],[C.HeaderPreviousPeriodButton,H.PreviousPeriod],[C.HeaderTitleButton,H.Title],[C.HeaderNextYearButton,H.NextYear],[C.HeaderNextMonthButton,H.NextMonth],[C.HeaderNextPeriodButton,H.NextPeriod]]),this.buttonTypeToButtonClass=new Map([[H.PreviousYear,C.HeaderPreviousYearButton],[H.PreviousMonth,C.HeaderPreviousMonthButton],[H.PreviousPeriod,C.HeaderPreviousPeriodButton],[H.Title,C.HeaderTitleButton],[H.NextYear,C.HeaderNextYearButton],[H.NextMonth,C.HeaderNextMonthButton],[H.NextPeriod,C.HeaderNextPeriodButton]])}getShortcutContext(){return{AreaType:N.Header,ButtonType:this.getSelectedButtonType()}}queryItems(){return this.queryItemsBySelector(this.itemSelector)}activate(){const e=this.getButtonIndexByType(this.lastFocusedButtonType);this.selectedItemIndex=this.isFocusedFromOutside()?0:this.isFocusedFromDataTable()?this.itemCount-1:null!=e?e:0,super.activate()}leaveBackward(){this.lastFocusedButtonType=void 0,super.leaveBackward()}leaveForward(){this.lastFocusedButtonType=void 0,super.leaveForward()}handleKeyDown(e){switch(v.KeyUtils.getEventKeyCode(e)){case v.KeyCode.Tab:return e.shiftKey?this.moveToPrevItem():this.moveToNextItem();case v.KeyCode.Space:case v.KeyCode.Enter:return this.performShortcutEvent(e),!0}return super.handleKeyDown(e)}moveToPrevItem(){return this.selectedItemIndex>0&&(this.selectItem(this.selectedItemIndex-1),!0)}moveToNextItem(){return this.selectedItemIndex<this.itemCount-1&&(this.selectItem(this.selectedItemIndex+1),!0)}updateSelectedItemByIndex(e){super.updateSelectedItemByIndex(e),this.lastFocusedButtonType=this.getSelectedButtonType()}getSelectedButtonType(){for(const e of this.selectedItemElement.classList)if(this.buttonClassToButtonType.has(e))return this.buttonClassToButtonType.get(e)}getButtonIndexByType(e){return e?this.items.findIndex((t=>t.classList.contains(this.buttonTypeToButtonClass.get(e)))):void 0}}class O extends Y{get isObsolete(){return this.calendar.currentView!==this.currentCalendarView}get targetElement(){return super.targetElement}constructor(e,t){super(e,t),this.boundCalendarFocusedDayChangedHandler=this.onCalendarFocusedDayChanged.bind(this),this.calendar.onFocusedDayChanged(this.boundCalendarFocusedDayChangedHandler)}activate(){this.applyCalendarFocus(),super.activate()}onDispose(){this.calendar.offFocusedDayChanged(this.boundCalendarFocusedDayChangedHandler),super.onDispose()}get daySelectionRenderer(){return this.calendar.daySelectionRenderer}getShortcutContext(){const e=this.lastShortcutArgs;return delete this.lastShortcutArgs,{AreaType:N.DataTable,Offset:null==e?void 0:e.offset,Row:null==e?void 0:e.row,Column:null==e?void 0:e.column,PeriodIndex:null==e?void 0:e.periodIndex,Date:null==e?void 0:e.date}}queryItems(){return this.queryItemsBySelector(this.itemSelector)}handleKeyDown(e){switch(v.KeyUtils.getEventKeyCode(e)){case v.KeyCode.Left:return!((e.ctrlKey||e.metaKey||e.altKey)&&!e.shiftKey)&&(this.moveToPrevDay(e),!0);case v.KeyCode.Right:return!((e.ctrlKey||e.metaKey||e.altKey)&&!e.shiftKey)&&(this.moveToNextDay(e),!0);case v.KeyCode.Up:return!((e.ctrlKey||e.metaKey||e.altKey)&&!e.shiftKey)&&(this.moveToPrevRow(e),!0);case v.KeyCode.Down:return!((e.ctrlKey||e.metaKey||e.altKey)&&!e.shiftKey)&&(this.moveToNextRow(e),!0);case v.KeyCode.Home:return this.handleHomeKey(e),!0;case v.KeyCode.End:return this.handleEndKey(e),!0;case v.KeyCode.PageUp:return this.calendar.scheduleFocusRestoration(),this.handlePageUpKey(e),!0;case v.KeyCode.PageDown:return this.calendar.scheduleFocusRestoration(),this.handlePageDownKey(e),!0;case v.KeyCode.Enter:case v.KeyCode.Space:return this.handleItemClick(e),!0}return super.handleKeyDown(e)}handleKeyUp(e){return this.isShiftKeyCode(e)&&this.stopSelectingDays(),super.handleKeyUp(e)}isShiftKeyCode(e){return 16===v.KeyUtils.getEventKeyCode(e)}getSelectedItemRowIndex(){return Math.floor(this.selectedItemIndex/this.rowLength)}getSelectedItemColumnIndex(){return Math.floor(this.selectedItemIndex%this.rowLength)}handlePageUpKey(e,t){this.prepareAndPerformShortcutEvent(e,{offset:null!=t?t:e.shiftKey?-12:-1,date:e.shiftKey?ee.getDateFromCell(this.selectedItemElement):void 0})}handlePageDownKey(e,t){this.prepareAndPerformShortcutEvent(e,{offset:null!=t?t:e.shiftKey?I:1,date:e.shiftKey?ee.getDateFromCell(this.selectedItemElement):void 0})}prepareAndPerformShortcutEvent(e,t){t.periodIndex=this.targetElement.periodIndex,this.lastShortcutArgs=t,this.performShortcutEvent(e)}onCalendarFocusedDayChanged(e){e&&(this.tryRestoreSelectedItem(e),this.selectItem(this.selectedItemIndex))}applyCalendarFocus(){var e;const t=null!==(e=this.calendar.getFocusedCellElementInView(this.currentCalendarView))&&void 0!==e?e:this.targetElement.querySelector(`.${C.SelectedItem}`);t&&this.tryRestoreSelectedItem(t)}initStartDaySelection(e){null===this.daySelectionRenderer&&e.shiftKey&&this.calendar.createDaySelectionRenderer(ee.getDateFromCell(this.selectedItemElement),!e.ctrlKey&&!e.metaKey)}stopSelectingDays(){null!==this.daySelectionRenderer&&(this.daySelectionRenderer.pointerUpDate=ee.getDateFromCell(this.selectedItemElement),this.calendar.stopSelectingDays())}}class z extends O{get rowLength(){return 7}get currentCalendarView(){return K.Month}get itemSelector(){return`:scope .${C.WeekRow} > .${C.Day}`}moveToPrevDay(e){var t,s;this.initStartDaySelection(e);const n=this.calendar.tryMoveFocus({value:-1,isHorizontal:!0},this.selectedItemElement);if(n.needChangePeriod)this.switchCurrentMonth(e,null!==(s=n.periodsToSkip)&&void 0!==s?s:-1);else{const s=null!==(t=n.unitsToSkip)&&void 0!==t?t:-1;this.selectedItemIndex>=s&&this.selectItem(this.selectedItemIndex+s),e.shiftKey&&this.extendSelection()}}moveToNextDay(e){var t,s;this.initStartDaySelection(e);const n=this.calendar.tryMoveFocus({value:1,isHorizontal:!0},this.selectedItemElement);if(n.needChangePeriod)this.switchCurrentMonth(e,null!==(s=n.periodsToSkip)&&void 0!==s?s:1);else{const s=null!==(t=n.unitsToSkip)&&void 0!==t?t:1;this.selectedItemIndex<this.itemCount-s&&this.selectItem(this.selectedItemIndex+s),e.shiftKey&&this.extendSelection()}}moveToPrevRow(e){var t,s;this.initStartDaySelection(e);const n=this.calendar.tryMoveFocus({value:-1,isHorizontal:!1},this.selectedItemElement);if(n.needChangePeriod)this.switchCurrentMonth(e,null!==(s=n.periodsToSkip)&&void 0!==s?s:-1);else{const s=null!==(t=n.unitsToSkip)&&void 0!==t?t:-this.rowLength;this.selectedItemIndex>=s&&this.selectItem(this.selectedItemIndex+s),e.shiftKey&&this.extendSelection()}}moveToNextRow(e){var t,s;this.initStartDaySelection(e);const n=this.calendar.tryMoveFocus({value:1,isHorizontal:!1},this.selectedItemElement);if(n.needChangePeriod)this.switchCurrentMonth(e,null!==(s=n.periodsToSkip)&&void 0!==s?s:1);else{const s=null!==(t=n.unitsToSkip)&&void 0!==t?t:this.rowLength;this.selectedItemIndex<this.itemCount-s&&this.selectItem(this.selectedItemIndex+s),e.shiftKey&&this.extendSelection()}}handleHomeKey(e){var t;const s=this.getSelectedItemRowIndex()*this.rowLength,n={value:s-this.selectedItemIndex,isHorizontal:!0};this.initStartDaySelection(e);const a=this.calendar.tryMoveFocus(n,this.selectedItemElement);a.needChangePeriod?this.switchCurrentMonth(e,null!==(t=a.periodsToSkip)&&void 0!==t?t:-1):(this.selectedItemIndex=void 0!==a.unitsToSkip?this.selectedItemIndex+a.unitsToSkip:s,this.selectItem(this.selectedItemIndex),e.shiftKey&&this.extendSelection())}handleEndKey(e){var t;const s=(this.getSelectedItemRowIndex()+1)*this.rowLength-1,n={value:s-this.selectedItemIndex,isHorizontal:!0};this.initStartDaySelection(e);const a=this.calendar.tryMoveFocus(n,this.selectedItemElement);a.needChangePeriod?this.switchCurrentMonth(e,null!==(t=a.periodsToSkip)&&void 0!==t?t:1):(this.selectedItemIndex=void 0!==a.unitsToSkip?this.selectedItemIndex+a.unitsToSkip:s,this.selectItem(this.selectedItemIndex),e.shiftKey&&this.extendSelection())}handlePageUpKey(e){const t=e.shiftKey?ee.getYearOffsetInDaysFrom(-1,this.selectedItemElement):ee.getMonthOffsetInDaysFrom(-1,this.selectedItemElement),s=this.calendar.tryMoveFocus({value:-t,isHorizontal:!0},this.selectedItemElement);s.needChangePeriod?super.handlePageUpKey(e,s.periodsToSkip):(this.applyCalendarFocus(),this.selectItem(this.selectedItemIndex))}handlePageDownKey(e){const t=e.shiftKey?ee.getYearOffsetInDaysFrom(1,this.selectedItemElement):ee.getMonthOffsetInDaysFrom(1,this.selectedItemElement),s=this.calendar.tryMoveFocus({value:t,isHorizontal:!0},this.selectedItemElement);s.needChangePeriod?super.handlePageDownKey(e,s.periodsToSkip):(this.applyCalendarFocus(),this.selectItem(this.selectedItemIndex))}extendSelection(){null!==this.daySelectionRenderer&&(this.daySelectionRenderer.pointerUpDate=ee.getDateFromCell(this.selectedItemElement))}handleItemClick(e){this.prepareAndPerformShortcutEvent(e,{date:ee.getDateFromCell(this.selectedItemElement)})}switchCurrentMonth(e,t){this.prepareAndPerformShortcutEvent(e,{offset:t,date:this.calendar.focusedDate})}}class V extends O{get rowLength(){return 4}moveToPrevDay(e){var t;const s=this.calendar.tryMoveFocus({value:-1,isHorizontal:!0},this.selectedItemElement);if(s.needChangePeriod)this.switchCurrentMonth(e,-1);else{const e=null!==(t=s.unitsToSkip)&&void 0!==t?t:-1;this.selectedItemIndex>=e&&this.selectItem(this.selectedItemIndex+e)}}moveToNextDay(e){var t;const s=this.calendar.tryMoveFocus({value:1,isHorizontal:!0},this.selectedItemElement);if(s.needChangePeriod)this.switchCurrentMonth(e,1);else{const e=null!==(t=s.unitsToSkip)&&void 0!==t?t:1;this.selectedItemIndex<this.itemCount-e&&this.selectItem(this.selectedItemIndex+e)}}moveToPrevRow(e){var t;const s=this.calendar.tryMoveFocus({value:-1,isHorizontal:!1},this.selectedItemElement);if(s.needChangePeriod)this.switchCurrentMonth(e,-1);else{const e=null!==(t=s.unitsToSkip)&&void 0!==t?t:-this.rowLength;this.selectedItemIndex>=e&&this.selectItem(this.selectedItemIndex+e)}}moveToNextRow(e){var t;const s=this.calendar.tryMoveFocus({value:1,isHorizontal:!1},this.selectedItemElement);if(s.needChangePeriod)this.switchCurrentMonth(e,1);else{const e=null!==(t=s.unitsToSkip)&&void 0!==t?t:this.rowLength;this.selectedItemIndex<this.itemCount-e&&this.selectItem(this.selectedItemIndex+e)}}handleHomeKey(e){const t=this.getIndexOfFirstAccessibleItemInCurrentView(),s=this.calendar.tryMoveFocus({value:t-this.selectedItemIndex,isHorizontal:!0},this.selectedItemElement);s.needChangePeriod||(this.selectedItemIndex=void 0!==s.unitsToSkip?this.selectedItemIndex+s.unitsToSkip:t,this.selectItem(this.selectedItemIndex))}handleEndKey(e){const t=this.getIndexOfLastAccessibleItemInCurrentView(),s=this.calendar.tryMoveFocus({value:t-this.selectedItemIndex,isHorizontal:!0},this.selectedItemElement);s.needChangePeriod||(this.selectedItemIndex=void 0!==s.unitsToSkip?this.selectedItemIndex+s.unitsToSkip:t,this.selectItem(this.selectedItemIndex))}handleItemClick(e){this.calendar.scheduleFocusRestoration(),this.prepareAndPerformShortcutEvent(e,{row:this.getSelectedItemRowIndex(),column:this.getSelectedItemColumnIndex()})}switchCurrentMonth(e,t){this.prepareAndPerformShortcutEvent(e,{offset:t})}getIndexOfFirstAccessibleItemInCurrentView(){let e=0;for(;e<=this.selectedItemIndex&&!this.itemBelongsToCurrentView(e);)e++;return e}getIndexOfLastAccessibleItemInCurrentView(){let e=this.itemCount-1;for(;e>=this.selectedItemIndex&&!this.itemBelongsToCurrentView(e);)e--;return e}itemBelongsToCurrentView(e){var t;return!(null===(t=this.getItem(e))||void 0===t?void 0:t.classList.contains(C.NotCurrentView))}}class A extends V{get currentCalendarView(){return K.Year}get itemSelector(){return`:scope .${C.YearRow} > td`}}class L extends V{get currentCalendarView(){return K.Decade}get itemSelector(){return`:scope .${C.DecadeRow} > td:not(.${s.Invisible})`}}class $ extends V{get currentCalendarView(){return K.Century}get itemSelector(){return`:scope .${C.CenturyRow} > td:not(.${s.Invisible})`}}class q extends Y{constructor(e,t){super(e,t),this.itemSelector=`:scope > .${s.Button}`}getShortcutContext(){return{AreaType:N.Footer,ButtonType:this.selectedItemIndex}}queryItems(){return this.queryItemsBySelector(this.itemSelector)}activate(){this.selectedItemIndex=this.isFocusedFromOutside()?this.itemCount-1:0,super.activate()}handleKeyDown(e){switch(v.KeyUtils.getEventKeyCode(e)){case v.KeyCode.Tab:return e.shiftKey?this.moveToPrevItem():this.moveToNextItem();case v.KeyCode.Space:case v.KeyCode.Enter:return this.performShortcutEvent(e),!0}return super.handleKeyDown(e)}moveToPrevItem(){return this.selectedItemIndex>0&&(this.selectItem(this.selectedItemIndex-1),!0)}moveToNextItem(){return this.selectedItemIndex<this.itemCount-1&&(this.selectItem(this.selectedItemIndex+1),!0)}}class j extends Y{constructor(e){super(e,e)}queryItems(){return new Array(this.getHeader(),this.getDataTableContainer(),this.getFooter())}createItemStrategy(e){if(e===this.getHeader())return new k(this.calendar,e);if(e===this.getDataTableContainer())return this.createDataTableStrategy(e);if(e===this.getFooter())return new q(this.calendar,e);throw new Error("Not implemented")}createDataTableStrategy(e){switch(e.viewType){case K.Month:return new z(this.calendar,e);case K.Year:return new A(this.calendar,e);case K.Decade:return new L(this.calendar,e);case K.Century:return new $(this.calendar,e)}}handleKeyDown(e){const t=v.KeyUtils.getEventKeyCode(e);if(t===v.KeyCode.Tab){if(e.shiftKey)return this.moveToPrevItem(),!0;if(this.selectedItemIndex<this.itemCount-1)return this.moveToNextItem(),!0}return!e.ctrlKey||t!==v.KeyCode.Up&&t!==v.KeyCode.Down?super.handleKeyDown(e):(this.calendar.scheduleFocusRestoration(),this.performShortcutEvent(e),!0)}moveToPrevItem(){this.selectedItemIndex>0?super.moveToPrevItem():(this.leaveBackward(),this.dispatchKeyboardNavigationLeavedEvent())}dispatchKeyboardNavigationLeavedEvent(){setTimeout((()=>this.targetElement.dispatchEvent(new M)),0)}}class X{get focusedItem(){return this._focusedItem}set focusedItem(e){this._focusedItem=e}get focusedElement(){return this._focusedElement}set focusedElement(e){this._focusedElement=e}get minDate(){return this._minDate}set minDate(e){this._minDate=e}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=e}get calendar(){return this._calendar}constructor(e){this.boundCalendarMinMaxDatesChangedHandler=this.updateMinMaxDates.bind(this),this._calendar=e,this._focusedElement=null,this._minDate=this._calendar.minDate,this._maxDate=this._calendar.maxDate,this.calendar.onMinMaxDatesChanged(this.boundCalendarMinMaxDatesChangedHandler)}get calendarCurrentViewDate(){return this.calendar.currentViewDate}getUpdatedElementToFocus(){return this.focusedElement=this.findCellElementByItem(this.getUpdatedItemToFocus()),this.focusedElement}updateMinMaxDates(e,t){e&&(this._minDate=e),t&&(this._maxDate=t)}}class J extends X{tryMoveFocus(e,t){const s=ee.getMonthFromCell(t);this.focusedItem=this.getMonthRelativeTo(e,s),void 0!==this.focusedItem&&(this.focusedItem=this.applyMinMaxDates(this.focusedItem)),this.focusedElement=this.findCellElementByItem(this.focusedItem);const n=this.focusedItem&&s?this.focusedItem-s:void 0;return{needChangePeriod:this.areMonthsDifferByYear(e,s),unitsToSkip:n}}getUpdatedItemToFocus(){if(void 0===this.focusedItem){const e=this.calendar.findSelectedCellElement();this.focusedItem=e?ee.getMonthFromCell(e):this.calendarCurrentViewDate.getMonth()}return this.focusedItem&&(this.focusedItem=this.applyMinMaxDates(this.focusedItem)),this.focusedItem}findCellElementByItem(e){return void 0===e?null:this.calendar.querySelector(`td[${S.dataMonth}="${B[e]}"]`)}applyMinMaxDates(e){return this.calendarCurrentViewDate.getFullYear()===this.minDate.getFullYear()&&e<this.minDate.getMonth()?this.minDate.getMonth():this.calendarCurrentViewDate.getFullYear()===this.maxDate.getFullYear()&&e>this.maxDate.getMonth()?this.maxDate.getMonth():e}getMonthRelativeTo(e,t){if(void 0===t)return;const s=(this.getRawIndex(e,t)%I+I)%I;return B[B[s%I]]}areMonthsDifferByYear(e,t){if(void 0===t)return!1;const s=this.getRawIndex(e,t);return s<0||s>=I}getEffectiveOffset(e){return e.value*(e.isHorizontal?1:4)}getRawIndex(e,t){return t+this.getEffectiveOffset(e)}}class W extends X{tryMoveFocus(e,t){const s=ee.getYearFromCell(t);this.focusedItem=this.getYearRelativeTo(e,s),void 0!==this.focusedItem&&(this.focusedItem=this.applyMinMaxDates(this.focusedItem)),this.focusedElement=this.findCellElementByItem(this.focusedItem);const n=this.focusedItem&&s?this.focusedItem-s:void 0;return{needChangePeriod:this.areYearsDifferByDecade(this.calendarCurrentViewDate.getFullYear(),this.focusedItem),unitsToSkip:n}}getUpdatedItemToFocus(){if(void 0===this.focusedItem){const e=this.calendar.findSelectedCellElement();this.focusedItem=e?ee.getYearFromCell(e):this.calendarCurrentViewDate.getFullYear()}return this.focusedItem&&(this.focusedItem=this.applyMinMaxDates(this.focusedItem)),this.focusedItem}findCellElementByItem(e){return void 0===e?null:this.calendar.querySelector(`td[${S.dataYear}="${e}"]`)}applyMinMaxDates(e){return e<this.minDate.getFullYear()?this.minDate.getFullYear():e>this.maxDate.getFullYear()?this.maxDate.getFullYear():e}getYearRelativeTo(e,t){if(void 0!==t)return t+this.getEffectiveOffset(e)}getEffectiveOffset(e){return e.value*(e.isHorizontal?1:4)}areYearsDifferByDecade(e,t){return void 0!==e&&void 0!==t&&Math.floor(e/10)!==Math.floor(t/10)}}class G extends X{tryMoveFocus(e,t){const s=ee.getDateFromCell(t);this.focusedItem=this.applyMinMaxDates(this.getDateRelativeTo(e,t)),this.focusedElement=this.findCellElementByItem(this.focusedItem);const n=this.areDatesDifferByMonthOrYear(this.calendarCurrentViewDate,this.focusedItem);return{needChangePeriod:n,periodsToSkip:n?this.getShortcutOffsetInMonths(this.focusedItem,this.calendarCurrentViewDate):void 0,unitsToSkip:this.focusedItem?Math.round((this.focusedItem.getTime()-s.getTime())/w):void 0}}getUpdatedItemToFocus(){if(this.focusedItem=this.getFindCachedFocusedItem(),this.areDatesDifferByMonthOrYear(this.focusedItem,this.calendarCurrentViewDate)){const e=this.focusedItem.getDate();this.focusedItem=new Date(this.calendarCurrentViewDate);let t=this.trySetDate(this.focusedItem,e);null===t&&(t=this.trySetDate(this.focusedItem,this.calendarCurrentViewDate.getDate())),null===t&&(t=this.trySetDate(this.focusedItem,1)),this.focusedItem=t}return this.focusedItem=this.applyMinMaxDates(this.focusedItem),this.focusedItem}getFindCachedFocusedItem(){let e=this.focusedItem;if(void 0===e){const t=this.calendar.findSelectedCellElement();e=t?ee.getDateFromCell(t):this.calendarCurrentViewDate}return e}findCellElementByItem(e){return void 0===e?null:this.calendar.querySelector(`.${C.Day}[${S.dataDate}="${e.getTime()}"]`)}applyMinMaxDates(e){return e<this.minDate?new Date(this.minDate):e>this.maxDate?new Date(this.maxDate):new Date(e)}areDatesDifferByMonthOrYear(e,t){return e.getMonth()!==t.getMonth()||this.areDatesDifferByYear(e,t)}areDatesDifferByYear(e,t){return e.getUTCFullYear()!==t.getUTCFullYear()}trySetDate(e,t){const s=new Date(e);return s.setDate(t),this.areDatesDifferByMonthOrYear(s,e)?null:s}getShortcutOffsetInMonths(e,t){return e.getMonth()-t.getMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*I}getDateRelativeTo(e,t){const s=ee.getDateFromCell(t),n=new Date(s);return new Date(n.setDate(n.getDate()+e.value*(e.isHorizontal?1:7)))}}class Q extends X{tryMoveFocus(e,t){const s=ee.getDecadeFromCell(t);this.focusedItem=this.getDecadeRelativeTo(e,s),void 0!==this.focusedItem&&(this.focusedItem=this.applyMinMaxDates(this.focusedItem)),this.focusedElement=this.findCellElementByItem(this.focusedItem);const n=this.focusedItem&&s?this.subtractDecade(this.focusedItem,s):void 0;return{needChangePeriod:this.areDecadesDifferByCentury(this.getCurrentDecade(),this.focusedItem),unitsToSkip:n}}getUpdatedItemToFocus(){if(void 0===this.focusedItem){const e=this.calendar.findSelectedCellElement();this.focusedItem=e?ee.getDecadeFromCell(e):this.getCurrentDecade()}return this.focusedItem&&(this.focusedItem=this.applyMinMaxDates(this.focusedItem)),this.focusedItem}findCellElementByItem(e){return void 0===e?null:this.calendar.querySelector(`td[${S.dataDecade}="${e.startYear}-${e.endYear}"]`)}applyMinMaxDates(e){return-1===this.compareDecades(e,this.getDecadeOfDate(this.minDate))?this.getDecadeOfDate(this.minDate):1===this.compareDecades(e,this.getDecadeOfDate(this.maxDate))?this.getDecadeOfDate(this.maxDate):e}getDecadeRelativeTo(e,t){if(void 0===t)return;const s=t.startYear+this.getEffectiveOffset(e);return{startYear:s,endYear:s+9}}getEffectiveOffset(e){return e.value*(e.isHorizontal?1:4)*10}areDecadesDifferByCentury(e,t){if(void 0===(null==e?void 0:e.startYear)||void 0===(null==t?void 0:t.startYear))return!1;return Math.floor(e.startYear/100)!==Math.floor(t.startYear/100)}getCurrentDecade(){return this.getDecadeOfDate(this.calendarCurrentViewDate)}getDecadeOfDate(e){const t=e.getFullYear(),s=10*Math.floor(t/10);return{startYear:s,endYear:s+9}}compareDecades(e,t){return e.startYear<t.startYear?-1:e.startYear===t.startYear?0:1}subtractDecade(e,t){return(e.startYear-t.startYear)/10}}const Z=document.createElement("template");Z.innerHTML="\n<style></style>\n<slot />";class ee extends t{constructor(){super(),this.boundOnStartDaySelectionHandler=this.onStartDaySelection.bind(this),this.boundOnStopDaySelectionHandler=this.onStopDaySelection.bind(this),this.boundOnCancelDaySelectionHandler=this.onCancelDaySelection.bind(this),this.boundOnDayCellPointerEnterHandler=this.onDayCellPointerEnter.bind(this),this._enableMultiSelect=!1,this._enableRangeSelect=!1,this._hasNullStartXorEndDate=!1,this._visiblePeriodsCount=1,this._focusedCellElement=null,this._focusRestorationScheduled=!0,this._minDate=x,this._maxDate=E,this._daySelectionRenderer=null,this.calendarTableResizeObservers=new Map,this.focusedDayChangedHandlers=new Set,this.minMaxDatesChangedHandlers=new Set}get enableMultiSelect(){return this._enableMultiSelect}set enableMultiSelect(e){this._enableMultiSelect=e}get enableRangeSelect(){return this._enableRangeSelect}set enableRangeSelect(e){this._enableRangeSelect=e}get hasNullStartXorEndDate(){return this._hasNullStartXorEndDate}set hasNullStartXorEndDate(e){this._hasNullStartXorEndDate=e}get visiblePeriodsCount(){return this._visiblePeriodsCount}set visiblePeriodsCount(e){this._visiblePeriodsCount=e}get currentViewDate(){return this.tableContainer.viewDate}get currentView(){var e,t;return null!==(t=null===(e=this.tableContainer)||void 0===e?void 0:e.viewType)&&void 0!==t?t:K.Month}get focusedDate(){return this._focusStrategies[K.Month].getFindCachedFocusedItem()}get tableContainer(){return this._tableContainer||(this._tableContainer=this.querySelector(`${b}`)),this._tableContainer}get minDate(){return this._minDate}set minDate(e){this._minDate=e}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=e}get daySelectionRenderer(){return this._daySelectionRenderer}connectedCallback(){super.connectedCallback(),this.addEventSubscriptions()}initializeComponent(){super.initializeComponent(),this._focusStrategies={[K.Month]:new G(this),[K.Year]:new J(this),[K.Decade]:new W(this),[K.Century]:new Q(this)},this.fixCalendarTableSize(),this.initializeKeyboardNavigator(),this.tryInitializeRangeSelectionSubscriptions()}disposeComponent(){this.removeEventSubscriptions(),this.focusedDayChangedHandlers.clear(),this.minMaxDatesChangedHandlers.clear(),super.disposeComponent()}disconnectedCallback(){this.calendarTableResizeObservers.forEach((e=>e.disconnect())),super.disconnectedCallback()}fixCalendarTableSize(){if(this.currentView!==K.Month)return;const e=this.getTableElements();e.length&&e.forEach((e=>{var t;if(!e)return;e.style.width="",e.style.height="";const s=e.getBoundingClientRect();D.fromDomRect(s).isEmpty?(this.calendarTableResizeObservers.set(e,new ResizeObserver(this.onCalendarTableSizeChanged.bind(this))),null===(t=this.calendarTableResizeObservers.get(e))||void 0===t||t.observe(e)):this.applyTableSize(e,s.width,s.height)}))}applyTableSize(e,t,s){e.style.width=t+"px",e.style.height=s+"px"}onCalendarTableSizeChanged(e){var t;if(e.length<1)return;const s=e[0].target,n=e[0].contentRect;D.fromDomRect(n).isEmpty||(this.applyTableSize(s,n.width,n.height),null===(t=this.calendarTableResizeObservers.get(s))||void 0===t||t.disconnect())}addEventSubscriptions(){this.addEventListener(o.eventName,this.boundOnStartDaySelectionHandler),this.addEventListener(l.eventName,this.boundOnStopDaySelectionHandler),this.addEventListener(d.eventName,this.boundOnCancelDaySelectionHandler),this.enableRangeSelect&&this.addEventListener(h.eventName,this.boundOnStartDaySelectionHandler)}removeEventSubscriptions(){this.removeEventListener(o.eventName,this.boundOnStartDaySelectionHandler),this.removeEventListener(l.eventName,this.boundOnStopDaySelectionHandler),this.removeEventListener(d.eventName,this.boundOnCancelDaySelectionHandler),this.removeEventListener(h.eventName,this.boundOnStartDaySelectionHandler)}addDayCellEventSubscriptions(){const e=this.findDayCellElements();for(let t=0;t<e.length;t++){e[t].addEventListener("pointerenter",this.boundOnDayCellPointerEnterHandler)}}removeDayCellEventSubscriptions(){const e=this.findDayCellElements();for(let t=0;t<e.length;t++){e[t].removeEventListener("pointerenter",this.boundOnDayCellPointerEnterHandler)}}tryInitializeRangeSelectionSubscriptions(){if(!this.hasNullStartXorEndDate)return;const e=this.findSelectedCellElement();if(!e)return;const t=ee.getDateFromCell(e);t&&(this.createDaySelectionRenderer(t,!0),this._daySelectionRenderer&&!ee.isDateCellDisabled(e)&&(this._daySelectionRenderer.pointerUpDate=t),this.addDayCellEventSubscriptions())}onStartDaySelection(t){if(e.DomUtils.hasClassName(this,s.Disabled)||e.DomUtils.hasClassName(this,s.ReadOnly))return;const n=ee.getDayCellByTarget(t.detail.source.target),a=ee.getDateFromTarget(t.detail.source.target);if(!n||!a)return;this.createDaySelectionRenderer(a,!t.detail.isLongTap&&(!(t.detail.source.ctrlKey||t.detail.source.metaKey)||t.detail.isTouch)),this._daySelectionRenderer&&!ee.isDateCellDisabled(n)&&(this._daySelectionRenderer.pointerUpDate=ee.getDateFromCell(n)),this.addDayCellEventSubscriptions(),t.stopPropagation()}onStopDaySelection(e){if(!this._daySelectionRenderer)return;const t=ee.getDayCellByTarget(e.detail.source.target);t&&!ee.isDateCellDisabled(t)&&(this._daySelectionRenderer.pointerUpDate=ee.getDateFromCell(t)),this.stopSelectingDays(),this.removeDayCellEventSubscriptions(),e.stopPropagation()}onCancelDaySelection(e){this._daySelectionRenderer&&(this._daySelectionRenderer.cancel(),this.removeDayCellEventSubscriptions(),this._daySelectionRenderer=null,e.stopPropagation())}stopSelectingDays(){this._daySelectionRenderer&&(this._daySelectionRenderer.stop(),this._daySelectionRenderer=null)}invokeDayCellPointerUp(e,t,s){this.dispatchEvent(new T(e,t,s))}onDayCellPointerEnter(e){const t=ee.getDayCellByTarget(e.target);this._daySelectionRenderer&&t&&!ee.isDateCellDisabled(t)&&(this._daySelectionRenderer.pointerUpDate=ee.getDateFromCell(t))}createDaySelectionRenderer(e,t){this._daySelectionRenderer=this.enableRangeSelect?this.createDateRangeSelectionRenderer(e,t):this.enableMultiSelect?this.createMultipleDaySelectionRenderer(e,t):this.createSingleDaySelectionRenderer(e,t)}createMultipleDaySelectionRenderer(e,t){return new R({pointerDownDate:e,clearSelection:t,dayCellElements:this.findDayCellElements()},this.invokeDayCellPointerUp.bind(this))}createSingleDaySelectionRenderer(e,t){return new P(e,t,this.invokeDayCellPointerUp.bind(this))}createDateRangeSelectionRenderer(e,t){return new _({pointerDownDate:e,clearSelection:t,dayCellElements:this.findDayCellElements()},this.invokeDayCellPointerUp.bind(this))}findDayCellElements(){return this.querySelectorAll(`.${C.Day}`)}findSelectedCellElement(){return this.querySelector(`td.${C.SelectedItem}`)}getMainElement(){return this.querySelector(`.${C.MainElement}`)}getHeaderElement(){return this.querySelector(`.${C.Header}`)}getTableElements(){return Array.from(this.querySelectorAll(`.${C.Content} > table`))}getFooterElement(){return this.querySelector(`.${C.Footer}`)}initializeKeyboardNavigator(){this.keyboardNavigator=this.querySelector(p),this.keyboardNavigator&&!this.keyboardNavigator.initialized&&this.keyboardNavigator.initialize(this,new j(this))}getKeyboardNavigator(){return this.keyboardNavigator}getFocusedCellElementInView(e){return this._focusStrategies[e].getUpdatedElementToFocus()}tryMoveFocus(e,t){const s=this._focusStrategies[this.currentView].tryMoveFocus(e,t);return s.needChangePeriod&&this.scheduleFocusRestoration(),s}scheduleFocusRestoration(){this._focusRestorationScheduled=!0}restoreFocus(){const e=this._focusStrategies[this.currentView].getUpdatedElementToFocus();this._focusRestorationScheduled&&(this._focusRestorationScheduled=!1,this.tryFireFocusedDayChanged(e),this.daySelectionRenderer&&e&&(this.daySelectionRenderer.pointerUpDate=ee.getDateFromCell(e)))}onFocusedDayChanged(e){this.focusedDayChangedHandlers.add(e)}offFocusedDayChanged(e){this.focusedDayChangedHandlers.delete(e)}onMinMaxDatesChanged(e){this.minMaxDatesChangedHandlers.add(e)}tryFireFocusedDayChanged(e){if(null!==e)for(const t of this.focusedDayChangedHandlers)t(e)}fireMinMaxDatesChanged(e,t){for(const s of this.minMaxDatesChangedHandlers)s(e,t)}static getDateFromTarget(e){const t=ee.getDayCellByTarget(e);return t?ee.getDateFromCell(t):null}static getDayCellByTarget(t){const s=t;return s?e.DomUtils.hasClassName(s,C.Day)?s:s.closest(`.${C.Day}`):null}static getDateFromCell(e){return new Date(Number(e.getAttribute(S.dataDate)))}static getMonthFromCell(e){const t=e.getAttribute(S.dataMonth);if(t)return B[t]}static getYearFromCell(e){const t=e.getAttribute(S.dataYear);if(t)return Number(t)}static getDecadeFromCell(e){const t=e.getAttribute(S.dataDecade);if(!t)return;const[s,n]=t.split("-").map(Number);return{startYear:s,endYear:n}}static getMonthOffsetInDaysFrom(e,t){const s=ee.getDateFromCell(t),n=s.getDate(),a=new Date(s);a.setDate(1),a.setMonth(a.getMonth()+e);const i=this.getLastDayOfTheMonth(a);return a.setDate(n>i?i:n),Math.round(Math.abs(a.getTime()-s.getTime())/w)}static getYearOffsetInDaysFrom(e,t){const s=ee.getDateFromCell(t),n=s.getDate(),a=new Date(s);a.setDate(1),a.setFullYear(a.getFullYear()+e);const i=this.getLastDayOfTheMonth(a);return a.setDate(n>i?i:n),Math.round(Math.abs(a.getTime()-s.getTime())/w)}static getLastDayOfTheMonth(e){return new Date(e.getFullYear(),e.getMonth()+1,0).getDate()}static isDateCellDisabled(e){return e.hasAttribute("data-disabled")}getContentTemplate(){return Z}static get observedAttributes(){return[f.class,f.enableMultiSelect,f.minDate,f.maxDate,f.enableRangeSelect,f.hasNullStartXorEndDate]}attributeChangedCallback(e,t,s){switch(e){case f.class:this.fixCalendarTableSize();break;case f.enableMultiSelect:this.enableMultiSelect=null!==s;break;case f.minDate:{const e=new Date(Number(s));this.minDate=e>=x?e:x,this.fireMinMaxDatesChanged(this.minDate);break}case f.maxDate:{const e=new Date(Number(s));this.maxDate=e<=E?e:E,this.fireMinMaxDatesChanged(void 0,this.maxDate);break}case f.visiblePeriodsCount:this.visiblePeriodsCount=Number(s);break;case f.enableRangeSelect:this.enableRangeSelect=null!==s,this.removeEventSubscriptions(),this.addEventSubscriptions();break;case f.hasNullStartXorEndDate:this.hasNullStartXorEndDate=null!==s,this.removeDayCellEventSubscriptions(),this.tryInitializeRangeSelectionSubscriptions(),this.removeEventSubscriptions(),this.addEventSubscriptions()}}}customElements.define(u,ee),customElements.define(b,U);const te={loadModule:function(){}},se=Object.freeze({__proto__:null,DxCalendar:ee,default:te});export{M as C,C as a,te as c,se as d};
