import{_ as t}from"./_tslib-6e8ca86b.js";import{j as e,D as i,B as o,h as s,k as a,a as n,b as r,V as l,F as h,m as c,n as m}from"./popup-1339ec31.js";import{P as d}from"./point-e4ec110e.js";import{b as u}from"./layouthelper-0c7c89da.js";import{x as p}from"./lit-element-462e7ad3.js";import{i as f}from"./query-44b9267f.js";import{n as g}from"./property-4ec0b52d.js";import{e as b}from"./custom-element-267f9a21.js";import"./rafaction-bba7928b.js";import"./screenhelper-cc818363.js";import"./transformhelper-ebad0156.js";import"./positiontracker-896b964e.js";import"./constants-791d6f9b.js";import"./branch-e081818f.js";import"./capturemanager-43e041e5.js";import"./eventhelper-8570b930.js";import"./focushelper-cb993bae.js";import"./logicaltreehelper-7b19cc30.js";import"./portal-8366b474.js";import"./data-qa-utils-8be7c726.js";import"./constants-058ebb50.js";import"./const-90026e45.js";import"./dx-html-element-pointer-events-helper-b4d2ae7e.js";import"./dom-da46d023.js";import"./browser-d96520d8.js";import"./common-f853e871.js";import"./devices-afeafb19.js";import"./dx-ui-element-822e6c84.js";import"./lit-element-base-32a69cc0.js";import"./dx-license-dd341102.js";import"./nameof-factory-64d95f5b.js";import"./custom-events-helper-e7f279d3.js";import"./focustrap-8a58142c.js";import"./key-f9cbed1b.js";import"./keyboard-navigation-strategy-940ff3b3.js";import"./focus-utils-405a64a8.js";import"./touch-4bff3f51.js";import"./disposable-d2c2d283.js";import"./dom-utils-c35907a1.js";import"./css-classes-cee8476c.js";var y,w;!function(t){t[t.TopStart=1]="TopStart",t[t.Top=2]="Top",t[t.TopEnd=4]="TopEnd",t[t.RightStart=8]="RightStart",t[t.Right=16]="Right",t[t.RightEnd=32]="RightEnd",t[t.BottomStart=64]="BottomStart",t[t.Bottom=128]="Bottom",t[t.BottomEnd=256]="BottomEnd",t[t.LeftStart=512]="LeftStart",t[t.Left=1024]="Left",t[t.LeftEnd=2048]="LeftEnd"}(w||(w={}));class j extends e{constructor(t,e,i,o,s,a){super(e,i,o,s,a),this.flyoutPosition=t}}const P="dxbl-flyout";let S=y=class extends i{get actualDistance(){var t;return null!==(t=this.flyoutDistance)&&void 0!==t?t:2}get actualOffset(){var t;return null!==(t=this.flyoutOffset)&&void 0!==t?t:0}get branchType(){return o.DropDown}constructor(){super(),this.slotChangedHandler=this.handleSlotChange.bind(this),this.dialog=null,this.flyoutDistance=null,this.flyoutOffset=null,this.calcStartAlignment=()=>0,this.calcEndAlignment=(t,e)=>e-t,this.calcAlignment=(t,e)=>e/2-t/2,this.placement=s.Custom,this.fitToRestriction=!0,this.flyoutPosition=0}get child(){return this.root}processCustomPlacement(t,e){return this.calcCustomPlacements(t,e)}calcCustomPlacements(t,e){const i=[];if(!this.dialog||!this.dialog.arrow)return i;const o=this.getBounds(e),s=this.getBounds(t),a=this.dialog.arrow.arrowSize;return this.flyoutPosition&w.Bottom&&i.push(this.calcBottomPlacement(o,a,this.calcAlignment(s.width,o.width),w.Bottom)),this.flyoutPosition&w.BottomStart&&i.push(this.calcBottomPlacement(o,a,this.calcStartAlignment(),w.BottomStart)),this.flyoutPosition&w.BottomEnd&&i.push(this.calcBottomPlacement(o,a,this.calcEndAlignment(s.width,o.width),w.BottomEnd)),this.flyoutPosition&w.Top&&i.push(this.calcTopPlacement(s,a,this.calcAlignment(s.width,o.width),w.Top)),this.flyoutPosition&w.TopStart&&i.push(this.calcTopPlacement(s,a,this.calcStartAlignment(),w.TopStart)),this.flyoutPosition&w.TopEnd&&i.push(this.calcTopPlacement(s,a,this.calcEndAlignment(s.width,o.width),w.TopEnd)),this.flyoutPosition&w.Left&&i.push(this.calcLeftPlacement(s,a,this.calcAlignment(s.height,o.height),w.Left)),this.flyoutPosition&w.LeftStart&&i.push(this.calcLeftPlacement(s,a,this.calcStartAlignment(),w.LeftStart)),this.flyoutPosition&w.LeftEnd&&i.push(this.calcLeftPlacement(s,a,this.calcEndAlignment(s.height,o.height),w.LeftEnd)),this.flyoutPosition&w.Right&&i.push(this.calcRightPlacement(o,a,this.calcAlignment(s.height,o.height),w.Right)),this.flyoutPosition&w.RightStart&&i.push(this.calcRightPlacement(o,a,this.calcStartAlignment(),w.RightStart)),this.flyoutPosition&w.RightEnd&&i.push(this.calcRightPlacement(o,a,this.calcEndAlignment(s.height,o.height),w.RightEnd)),i}calcLeftPlacement(t,e,i,o){const s=new d(-t.width-e.width-this.actualDistance,i+this.actualOffset);return new j(o,s,a.Horizontal,!0,n.Near,r.bottom)}calcTopPlacement(t,e,i,o){const s=new d(i+this.actualOffset,-t.height-e.height-this.actualDistance);return new j(o,s,a.Vertical,!0,n.Near,r.top)}calcRightPlacement(t,e,i,o){const s=new d(t.width+e.width+this.actualDistance,i+this.actualOffset);return new j(o,s,a.Horizontal,!1,n.Far,r.bottom)}calcBottomPlacement(t,e,i,o){const s=new d(i+this.actualOffset,t.height+e.height+this.actualDistance);return new j(o,s,a.Vertical,!1,n.Near,r.bottom)}processBestTranslationResults(t,e,i,o,s,a,n,r,l){if(super.processBestTranslationResults(t,e,i,o,s,a,n,r,l),!this.dialog||!this.dialog.arrow)return;const h=this.calcArrowAlignment(a,n,r);this.dialog.arrowAlignment=h;const c=this.dialog.arrow;c.position=this.getArrowPosition(c,e,i,o,r,null==l?void 0:l.flyoutPosition),c.alignment=h}getArrowPosition(t,e,i,o,s,n){const r=s===a.Vertical,h=r?t.arrowSize.width:t.arrowSize.height,c=u.rectToRange(i,r),m=u.rectToRange(e,r),d=u.rectToRange(o,r);let p=m.start,f=m.end;this.fitToRestriction&&(m.start<=d.start?(p=d.start,f=p+m.size):m.end>=d.end&&(p=d.end-m.size,f=p+m.size));const[g,b]=[Math.max(p,c.start),Math.min(f,c.end)];let y;y=n&(w.RightStart|w.RightEnd|w.LeftStart|w.LeftEnd)?c.start:c.start+c.size/2;const j=this.alignWithinBoundaries(y-h/2,g,b),P=this.calculateArrowOffsetFromEdge(c,h,m);return r?new l(Math.min(Math.max(j-p,P),e.width-P-h),0):new l(0,Math.min(Math.max(j-f,P-e.height),-P-h))}calcArrowAlignment(t,e,i){return i===a.Vertical?e===r.bottom?h.bottom:h.top:t===n.Near?h.start:h.end}alignWithinBoundaries(t,e,i){return e>=i?(e+i)/2:Math.min(Math.max(t,e),i)}calculateArrowOffsetFromEdge(t,e,i){const o=Math.min(t.size-e,t.size/2-e/2);return Math.max(y.DefaultArrowOffsetFromEdge,Math.min(o,.2*i.size))}renderTemplate(){return p`
            <dxbl-branch
                id="branch"
                branch-id="${this.branchId}"
                parent-branch-id="${this.parentBranchId}"
                type="${o.Flyout}">
                <dxbl-flyout-root
                    id="root"
                    style="${this.rootCssStyle}">
                    ${this.renderDefaultSlot()}
                    ${this.renderBridgeSlot()}
                </dxbl-flyout-root>
            </dxbl-branch>
        `}renderDefaultSlot(){return p`<slot @slotchange="${this.slotChangedHandler}"></slot>`}handleSlotChange(t){const e=t.target.assignedNodes();this.dialog=e.find((t=>t instanceof c)),this.dialog&&(this.dialog.animationEnabled=this.animationEnabled),this.reposition()}updated(t){super.updated(t),this.dialog&&t.has("animationEnabled")&&(this.dialog.animationEnabled=this.animationEnabled)}createKeyboardNavigationStrategy(){return new m(this.keyboardNavigator,this)}};S.DefaultArrowOffsetFromEdge=8,t([f("#root",!0)],S.prototype,"root",void 0),t([g({type:Number,attribute:"flyout-position"})],S.prototype,"flyoutPosition",void 0),t([g({type:Number,attribute:"flyout-distance"})],S.prototype,"flyoutDistance",void 0),t([g({type:Number,attribute:"flyout-offset"})],S.prototype,"flyoutOffset",void 0),S=y=t([b(P)],S);const E={DxFlyout:S,dxFlyoutTagName:P};export{j as CustomFlyoutPlacement,S as DxFlyout,w as FlyoutPosition,E as default,P as dxFlyoutTagName};
