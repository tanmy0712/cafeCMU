import{k as e}from"./key-f9cbed1b.js";import{P as t,S as s,a as u,b as n,c as o,d as r,e as a}from"./menu-keyboard-strategy-ec303e3a.js";import{removeFocusHiddenAttribute as c}from"./focus-utils-405a64a8.js";class i extends t{constructor(e,t,u,n){super(e,t),this._focusSemaphore=new s,this._menuItemSelector=u,this._parentStrategy=n}get parentStrategy(){return this._parentStrategy}get menuItemSelector(){return this._menuItemSelector}queryItems(){return this.queryItemsBySelector(this._menuItemSelector)}doAction(e){this.doClick(this.selectedItemElement,e),u(this.selectedItemElement)&&this.focusSubMenuItemAsync(n.First)}handleKeyDown(t){return this._focusSemaphore.doAllowedFunc((()=>e.KeyUtils.getEventKeyCode(t)===e.KeyCode.Right&&this.subMenuStrategy&&o(this.targetElement)?(this.subMenuStrategy.focusFirstItem(),!0):super.handleKeyDown(t)))}openSubMenu(e){this.openSubMenuAsync(e)}async openSubMenuAsync(e){this.requestSubMenuOpen(),await this.focusSubMenuItemAsync(e)}async focusSubMenuItemAsync(e){const t=await this.waitSubMenuShown();c(t.targetElement),e===n.Last?t.focusLastItem():t.focusFirstItem()}closeSubMenu(){this.selectedItemElement.dispatchEvent(new r(a.Collapse))}handlePopupShown(){this._parentStrategy.onSubMenuShown(this)}handlePopupClosed(){this._parentStrategy.onSubMenuClosed(this)}focusFirstItem(){this.subMenuStrategy?this.subMenuStrategy.focusFirstItem():super.focusFirstItem()}focusLastItem(){this.subMenuStrategy?this.subMenuStrategy.focusLastItem():super.focusLastItem()}focusItem(e){this._focusSemaphore.doAllowedAction((()=>{super.focusItem(e)}))}restoreFocus(){this._focusSemaphore.doAllowedAction((()=>{super.restoreFocus()}))}focusSelectedItem(){this._focusSemaphore.doIfAllowed((()=>{super.focusSelectedItem()}))}}class h extends i{createSubMenuStrategy(e,t){return new m(e,t,this.menuItemSelector,this)}closeSelf(){return!1}}class m extends i{createSubMenuStrategy(e,t){return new m(e,t,this.menuItemSelector,this)}closeSelf(){return this.parentStrategy.closeSubMenu(),!0}}export{h as D,i as a,m as b};
