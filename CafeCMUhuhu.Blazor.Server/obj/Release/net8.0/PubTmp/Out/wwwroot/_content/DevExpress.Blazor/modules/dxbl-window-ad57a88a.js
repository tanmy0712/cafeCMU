import{_ as t}from"./_tslib-6e8ca86b.js";import{DxDropDownBase as e}from"./dropdown-c4908e0b.js";import{p as i,g as o,h as r,C as n,i as s,B as a,j as l,k as p,a as h,b as c,P as u,Z as d,l as m}from"./popup-1339ec31.js";import{r as w,D as g}from"./dropdowncomponents-4ccadb32.js";import{P as f}from"./point-e4ec110e.js";import{x as b}from"./lit-element-462e7ad3.js";import{n as y}from"./property-4ec0b52d.js";import{e as j}from"./custom-element-267f9a21.js";import"./thumb-c80aa4fc.js";import"./data-qa-utils-8be7c726.js";import"./eventhelper-8570b930.js";import"./browser-d96520d8.js";import"./layouthelper-0c7c89da.js";import"./constants-791d6f9b.js";import"./custom-events-helper-e7f279d3.js";import"./query-44b9267f.js";import"./rafaction-bba7928b.js";import"./screenhelper-cc818363.js";import"./transformhelper-ebad0156.js";import"./positiontracker-896b964e.js";import"./branch-e081818f.js";import"./capturemanager-43e041e5.js";import"./focushelper-cb993bae.js";import"./logicaltreehelper-7b19cc30.js";import"./portal-8366b474.js";import"./constants-058ebb50.js";import"./const-90026e45.js";import"./dx-html-element-pointer-events-helper-b4d2ae7e.js";import"./dom-da46d023.js";import"./common-f853e871.js";import"./devices-afeafb19.js";import"./dx-ui-element-822e6c84.js";import"./lit-element-base-32a69cc0.js";import"./dx-license-dd341102.js";import"./nameof-factory-64d95f5b.js";import"./focustrap-8a58142c.js";import"./key-f9cbed1b.js";import"./keyboard-navigation-strategy-940ff3b3.js";import"./focus-utils-405a64a8.js";import"./touch-4bff3f51.js";import"./disposable-d2c2d283.js";import"./dom-utils-c35907a1.js";import"./css-classes-cee8476c.js";import"./popupportal-87b21a6c.js";import"./events-interseptor-35e91aec.js";function x(){return new Promise(((t,e)=>{requestAnimationFrame((()=>{setTimeout(t)}))}))}var A,z,C;!function(t){t.Center="Center",t.Left="Left",t.Right="Right"}(z||(z={})),function(t){t.Top="Top",t.Center="Center",t.Bottom="Bottom"}(C||(C={}));let S=class extends o{constructor(){super(...arguments),this.allowResize=!1}get header(){return this.querySelector(".dxbl-window-header")}render(){return this.allowResize?b`<dxbl-popup-resizable-container><slot></slot></dxbl-popup-resizable-container>`:b`<slot></slot>`}};t([y({type:Boolean,attribute:"allow-resize",reflect:!1})],S.prototype,"allowResize",void 0),S=t([j("dxbl-window-dialog")],S);let v=class extends g{constructor(){super()}};v=t([j("dxbl-window-root")],v);let T=A=class extends e{constructor(){super(),this.actualSize=null,this.actualPosition=null,this.initialSize=null,this.initialPosition=null,this.actualMinWidth=null,this.actualMaxWidth=null,this.actualMinHeight=null,this.actualMaxHeight=null,this.sizeDirty=!1,this.positionYDirty=!1,this.positionXDirty=!1,this.showAnchorElement=null,this._showOptionsToApply=null,this.isAdjustDialogEnabled=!0,this.horizontalAlignment=z.Center,this.verticalAlignment=C.Center,this.closeOnEscape=!1,this.placement=r.Custom,this.closeMode=n.None,s(this)}get branchType(){return a.Window}get canAdjustZIndexOnShow(){return!1}get positionY(){return this.offset.y}set positionY(t){this.positionYDirty=!0,this.offset=new f(this.positionX||0,t||0)}get positionX(){return this.offset.x}set positionX(t){this.positionXDirty=!0,this.offset=new f(t||0,this.positionY||0)}get showOptionsToApply(){return this._showOptionsToApply}set showOptionsToApply(t){this._showOptionsToApply=t,this.positionXDirty=!1,this.positionYDirty=!1}move(t){return this.showOptionsToApply=t,this.forceReposition(),x()}showAt(t){return this.showOptionsToApply=t,super.show(),x()}show(){this.showAt(this.showOptionsToApply).catch((t=>{}))}static getPlacementTargetClientRect(t){if(null!==t){if(null!==t.targetReference&&t.targetReference instanceof HTMLElement)return t.targetReference.getBoundingClientRect();if(null!==t.targetSelector){const e=document.querySelector(t.targetSelector);if(null!==e)return e.getBoundingClientRect()}}return{x:0,y:0,width:window.innerWidth,height:window.innerHeight}}static getShowAtBox(t){return null===t?null:null!==t.targetReference&&t.targetReference instanceof HTMLElement?A.getElementTopLeftPoint(t.targetReference):null!==t.targetSelector?A.getElementTopLeftPoint(document.querySelector(t.targetSelector)):t.targetPoint}static getElementTopLeftPoint(t){if(null===t)return null;const e=t.getBoundingClientRect();return new f(e.left,e.top)}canProcessEscapeKeyDown(){return this.closeOnEscape}renderTemplate(){return b`
            <dxbl-branch
                id="branch"
                branch-id="${this.branchId}"
                parent-branch-id="${this.parentBranchId}"
                type="${this.branchType}"
                style="${this.dragCssStyle}">
                <dxbl-window-root
                    id="root"
                    style="${this.rootCssStyle}"
                    ?resizing="${this.resizing}"
                    drop-opposite="${this.actualDropOpposite}"
                    drop-direction="${this.actualDropDirection}"
                    drop-alignment="${this.actualDropAlignment}">
                    ${this.renderDefaultSlot()}
                    ${this.renderAdditionalSlots()}
                    ${this.renderBridgeSlot()}
                </dxbl-window-root>
            </dxbl-branch>
        `}raiseResizeCompleted(t,e){this.sizeDirty=!0,super.raiseResizeCompleted(t,e)}processCustomPlacement(t,e){if(this.positionXDirty||this.positionYDirty||this.isInDragOperation||this.sizeDirty)return null;const i=this.showOptionsToApply;if(i){const t=i.targetPoint||this.calcShowPoint(i);return[new l(t,p.None,!1,h.Near,c.bottom)]}return null}calcShowPoint(t){const e=A.getPlacementTargetClientRect(t),i=this.getBoundingClientRect(),o=document.body.getBoundingClientRect(),r=null!=window.visualViewport?{x:0,y:0,width:window.visualViewport.width,height:window.visualViewport.height}:o,n=this.calcShowXPoint(i,e),s=this.calcShowYPoint(i,e),a=r.y+r.height-i.height;return new f(Math.max(0,n+window.scrollX-Math.max(0,n-(r.x+r.width-i.width))),Math.max(0,s+window.scrollY-Math.max(0,s-a)))}calcShowXPoint(t,e){return Math.floor((()=>{switch(this.horizontalAlignment){case z.Left:return e.x;case z.Right:return e.x+e.width-t.width;case z.Center:return e.x+e.width/2-t.width/2}throw new Error("calcShowXPoint not supported for horizontalAlignment:"+this.horizontalAlignment)})())}calcShowYPoint(t,e){return Math.floor((()=>{switch(this.verticalAlignment){case C.Top:return e.y;case C.Bottom:return e.y+e.height-t.height;case C.Center:return e.y+e.height/2-t.height/2}throw new Error("calcShowYPoint not supported for horizontalAlignment:"+this.verticalAlignment)})())}updated(t){super.update(t),t.has("zIndex")&&this.zIndex&&this.raiseZIndexChange()}raiseZIndexChange(){this.updateComplete.then((t=>{this.dispatchEvent(new u(new d(this.zIndex)))}))}createKeyboardNavigationStrategy(){return new m(this.keyboardNavigator,this)}};function P(t){if(!t)throw new Error("failed");return t}t([y({type:z,attribute:"horizontal-alignment",reflect:!1})],T.prototype,"horizontalAlignment",void 0),t([y({type:z,attribute:"vertical-alignment",reflect:!1})],T.prototype,"verticalAlignment",void 0),t([y({type:Number,attribute:"position-y",reflect:!1})],T.prototype,"positionY",null),t([y({type:Number,attribute:"position-x",reflect:!1})],T.prototype,"positionX",null),t([y({type:Boolean,attribute:"close-on-escape"})],T.prototype,"closeOnEscape",void 0),T=A=t([j("dxbl-window")],T);export{T as DxWindow,P as getWindowRef};
